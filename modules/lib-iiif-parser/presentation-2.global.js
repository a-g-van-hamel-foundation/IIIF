"use strict";var IIIFParser=(()=>{var v=Object.defineProperty;var Z=Object.getOwnPropertyDescriptor;var ee=Object.getOwnPropertyNames;var te=Object.prototype.hasOwnProperty;var ie=(t,e,i)=>e in t?v(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var ne=(t,e)=>{for(var i in e)v(t,i,{get:e[i],enumerable:!0})},re=(t,e,i,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of ee(e))!te.call(t,a)&&a!==i&&v(t,a,{get:()=>e[a],enumerable:!(n=Z(e,a))||n.enumerable});return t};var ae=t=>re(v({},"__esModule",{value:!0}),t);var d=(t,e,i)=>(ie(t,typeof e!="symbol"?e+"":e,i),i);var ot={};ne(ot,{Traverse:()=>u,convertLanguageMapping:()=>c,convertPresentation2:()=>st,getProfile:()=>_,getTypeFromContext:()=>Q,identifyResource:()=>C,presentation2to3:()=>Y,types:()=>y});var y=["sc:Collection","sc:Manifest","sc:Canvas","sc:AnnotationList","oa:Annotation","sc:Range","sc:Layer","sc:Sequence","oa:Choice","Service","ContentResource"];function C(t){if(typeof t>"u"||t===null)throw new Error("Null or undefined is not a valid entity.");if(Array.isArray(t))throw new Error("Array is not a valid entity");if(typeof t!="object")throw new Error(`${typeof t} is not a valid entity`);if(typeof t["@type"]=="string"){let e=y.indexOf(t["@type"]);if(e!==-1)return y[e]}if(t.profile)return"Service";if(t.format||t["@type"])return"ContentResource";throw new Error("Resource type is not known")}var u=class t{constructor(e,i={}){d(this,"traversals");d(this,"options");this.traversals={collection:[],manifest:[],canvas:[],annotationList:[],sequence:[],annotation:[],contentResource:[],choice:[],range:[],service:[],layer:[],...e},this.options={convertPropsToArray:!0,mergeMemberProperties:!0,allowUndefinedReturn:!1,...i}}static all(e){return new t({collection:[e],manifest:[e],canvas:[e],annotationList:[e],sequence:[e],annotation:[e],contentResource:[e],choice:[e],range:[e],service:[e],layer:[e]})}traverseCollection(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCollectionItems(e))),this.traversals.collection)}traverseCollectionItems(e){if(this.options.mergeMemberProperties){let i=[...(e.manifests||[]).map(n=>typeof n=="string"?{"@id":n,"@type":"sc:Manifest"}:n),...(e.collections||[]).map(n=>typeof n=="string"?{"@id":n,"@type":"sc:Collection"}:n),...e.members||[]];delete e.collections,delete e.manifests,e.members=i}return e.manifests&&(e.manifests=e.manifests.map(i=>this.traverseManifest(typeof i=="string"?{"@id":i,"@type":"sc:Manifest"}:i))),e.collections&&(e.collections=e.collections.map(i=>this.traverseCollection(typeof i=="string"?{"@id":i,"@type":"sc:Collection"}:i))),e.members&&(e.members=e.members.map(i=>typeof i=="string"?i:this.traverseUnknown(i))),e}traverseManifest(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseManifestItems(e))),this.traversals.manifest)}traverseManifestItems(e){return e.sequences&&(e.sequences=e.sequences.map(i=>this.traverseSequence(i))),e.structures&&(e.structures=e.structures.map(i=>this.traverseRange(i))),e}traverseSequence(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseSequenceItems(e))),this.traversals.sequence)}traverseSequenceItems(e){return e.canvases&&(e.canvases=e.canvases.map(i=>this.traverseCanvas(i))),e}traverseCanvas(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCanvasItems(e))),this.traversals.canvas)}traverseCanvasItems(e){return e.images&&(e.images=e.images.map(i=>this.traverseAnnotation(i))),e.otherContent&&(e.otherContent=e.otherContent.map(i=>this.traverseAnnotationList(i))),e}traverseRange(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseRangeItems(e))),this.traversals.range)}traverseRangeItems(e){if(this.options.mergeMemberProperties){let i=[...(e.ranges||[]).map(n=>typeof n=="string"?{"@id":n,"@type":"sc:Range"}:n),...(e.canvases||[]).map(n=>typeof n=="string"?{"@id":n,"@type":"sc:Canvas"}:n),...e.members||[]];delete e.ranges,delete e.canvases,e.members=i.length?i.map(n=>this.traverseUnknown(n)):void 0}return e}traverseAnnotationList(e){let i=typeof e=="string"?{"@id":e,"@type":"sc:AnnotationList"}:e;return this.traverseType(this.traverseDescriptive(this.traverseAnnotationListItems(i)),this.traversals.annotationList)}traverseAnnotationListItems(e){return e.resources&&(e.resources=e.resources.map(i=>this.traverseAnnotation(i))),e}traverseAnnotation(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationItems(e))),this.traversals.annotation)}traverseAnnotationItems(e){return e.resource&&(Array.isArray(e.resource)?e.resource=e.resource.map(i=>this.traverseContentResource(i)):e.resource=this.traverseContentResource(e.resource)),e.on,e}traverseLayer(e){return this.traverseType(this.traverseLinking(this.traverseLayerItems(e)),this.traversals.layer)}traverseLayerItems(e){return e.otherContent&&(e.otherContent=e.otherContent.map(i=>this.traverseAnnotationList(i))),e}traverseChoice(e){return this.traverseType(this.traverseChoiceItems(e),this.traversals.choice)}traverseChoiceItems(e){return e.default&&e.default!=="rdf:nil"&&(e.default=this.traverseContentResource(e.default)),e.item&&e.item!=="rdf:nil"&&(e.item=e.item.map(i=>this.traverseContentResource(i))),e}traverseService(e){return this.traverseType(this.traverseLinking(e),this.traversals.service)}traverseContentResource(e){return e["@type"]==="oa:Choice"?this.traverseChoice(e):this.traverseType(this.traverseDescriptive(this.traverseLinking(e)),this.traversals.contentResource)}traverseUnknown(e){if(!e["@type"]||typeof e=="string")return e;switch(C(e)){case"sc:Collection":return this.traverseCollection(e);case"sc:Manifest":return this.traverseManifest(e);case"sc:Canvas":return this.traverseCanvas(e);case"sc:Sequence":return this.traverseSequence(e);case"sc:Range":return this.traverseRange(e);case"oa:Annotation":return this.traverseAnnotation(e);case"sc:AnnotationList":return this.traverseAnnotationList(e);case"sc:Layer":return this.traverseLayer(e);case"Service":return this.traverseService(e);case"oa:Choice":return this.traverseChoice(e);case"ContentResource":return this.traverseContentResource(e)}return e.profile?this.traverseService(e):e}traverseImageResource(e){let i=Array.isArray(e),n=Array.isArray(e)?e:[e],a=[];for(let r of n)typeof r=="string"?a.push(this.traverseContentResource({"@id":r,"@type":"dctypes:Image"})):a.push(this.traverseContentResource(r));return!i&&!this.options.convertPropsToArray?a[0]:a}traverseDescriptive(e){return e.thumbnail&&(e.thumbnail=this.traverseImageResource(e.thumbnail)),e.logo&&(e.logo=this.traverseImageResource(e.logo)),e}traverseOneOrMoreServices(e){let i=Array.isArray(e),n=Array.isArray(e)?e:[e],a=[];for(let r of n)a.push(this.traverseService(r));return!i&&!this.options.convertPropsToArray?a[0]:a}traverseLinking(e){return e.related&&(e.related=this.traverseOneOrManyType(e.related,this.traversals.contentResource)),e.rendering&&(e.rendering=this.traverseOneOrManyType(e.rendering,this.traversals.contentResource)),e.service&&(e.service=this.traverseOneOrMoreServices(e.service)),e.seeAlso&&(e.seeAlso=this.traverseOneOrManyType(e.seeAlso,this.traversals.contentResource)),e.within&&(typeof e.within=="string"||(e.within=this.traverseOneOrManyType(e.within,this.traversals.contentResource))),e.startCanvas&&(typeof e.startCanvas=="string"?e.startCanvas=this.traverseType({"@id":e.startCanvas,"@type":"sc:Canvas"},this.traversals.canvas):e.startCanvas&&this.traverseType(e.startCanvas,this.traversals.canvas)),e.contentLayer&&(typeof e.contentLayer=="string"?e.contentLayer=this.traverseLayer({"@id":e.contentLayer,"@type":"sc:Layer"}):e.contentLayer=this.traverseLayer(e.contentLayer)),e}traverseOneOrManyType(e,i){if(!Array.isArray(e))if(this.options.convertPropsToArray)e=[e];else return this.traverseType(e,i);return e.map(n=>this.traverseType(n,i))}traverseType(e,i){return i.reduce((n,a)=>{let r=a(n);return typeof r>"u"&&!this.options.allowUndefinedReturn?n:r},e)}};var se="http://library.stanford.edu/iiif/image-api/compliance.html#level1",oe="http://library.stanford.edu/iiif/image-api/compliance.html#level2";var pe="http://library.stanford.edu/iiif/image-api/conformance.html#level1",fe="http://library.stanford.edu/iiif/image-api/conformance.html#level2";var le="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",ce="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2";var he="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",ue="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2";var ve="http://iiif.io/api/image/1/level1.json",de="http://iiif.io/api/image/1/profiles/level1.json",ye="http://iiif.io/api/image/1/level2.json",ge="http://iiif.io/api/image/1/profiles/level2.json";var me="http://iiif.io/api/image/2/level1.json",Ie="http://iiif.io/api/image/2/profiles/level1.json",_e="http://iiif.io/api/image/2/level2.json",Ae="http://iiif.io/api/image/2/profiles/level2.json";var Ce="level1",Ee="level2";var xe="http://iiif.io/api/image/2/level1",Pe="http://iiif.io/api/image/2/level2",E=[xe,Pe,se,oe,pe,fe,le,ce,he,ue,ve,de,ye,ge,me,Ie,_e,Ae,Ce,Ee];function x(t){return Array.isArray(t)?t:t?[t]:[]}function o(t){for(let e in t)(typeof t[e]>"u"||t[e]===null)&&delete t[e];return t}var Le="http://library.stanford.edu/iiif/image-api/compliance.html#level0",P="http://library.stanford.edu/iiif/image-api/compliance.html#level1",L="http://library.stanford.edu/iiif/image-api/compliance.html#level2",Re="http://library.stanford.edu/iiif/image-api/conformance.html#level0",R="http://library.stanford.edu/iiif/image-api/conformance.html#level1",M="http://library.stanford.edu/iiif/image-api/conformance.html#level2",Me="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",T="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",O="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",Te="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",F="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",S="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",Oe="http://iiif.io/api/image/1/level0.json",Fe="http://iiif.io/api/image/1/profiles/level0.json",b="http://iiif.io/api/image/1/level1.json",N="http://iiif.io/api/image/1/profiles/level1.json",w="http://iiif.io/api/image/1/level2.json",G="http://iiif.io/api/image/1/profiles/level2.json",Se="http://iiif.io/api/image/2/level0.json",be="http://iiif.io/api/image/2/profiles/level0.json",D="http://iiif.io/api/image/2/level1.json",j="http://iiif.io/api/image/2/profiles/level1.json",k="http://iiif.io/api/image/2/level2.json",V="http://iiif.io/api/image/2/profiles/level2.json",Ne="level0",B="level1",q="level2",we="http://iiif.io/api/image/2/level0",W="http://iiif.io/api/image/2/level1",U="http://iiif.io/api/image/2/level2",g=[U,L,M,O,S,w,G,k,V,q],vt=[...g,W,P,R,T,F,b,N,D,j,B],Ge=[we,W,U,Le,P,L,Re,R,M,Me,T,O,Te,F,S,Oe,Fe,b,N,w,G,Se,be,D,j,k,V,Ne,B,q],z=Ge;var m={attributionLabel:"Attribution",lang:"none",providerId:"http://example.org/provider",providerName:"Unknown"};function De(t){if(typeof t=="string")return[t];if(!t)return[];let e=Array.isArray(t)?t:[t],i=[];for(let n of e){if(typeof n=="string"){i.push(n);continue}i.push({"@language":n["@language"]||n.language,"@value":n["@value"]||n.value})}return i}function c(t,e="none"){if(!t)return{none:[""]};let i=De(t),n={};for(let a of i){if(typeof a=="string"){n[e]=n[e]?n[e]:[],n[e].push(a||"");continue}if(!a["@language"]){n[e]=n[e]?n[e]:[],n[e].push(a["@value"]||"");continue}let r=a["@language"];n[r]=n[r]?n[r]:[],n[r].push(a["@value"]||"")}return Object.keys(n).length===0?{none:[""]}:n}function _(t){if(Array.isArray(t))return _(t.find(e=>typeof e=="string"));if(g.indexOf(t)!==-1)return"level2";if(E.indexOf(t)!==-1)return"level1";if(z.indexOf(t)!==-1)return"level0";if(typeof t=="string")return t}function Q(t){let e=Array.isArray(t)?t:[t];for(let i of e)switch(i){case"http://iiif.io/api/image/2/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2":return"ImageService2";case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":return"ImageService1";case"http://iiif.io/api/annex/openannotation/context.json":return"ImageApiSelector"}}function je(t){switch(t){case"http://iiif.io/api/image/2/level0.json":case"http://iiif.io/api/image/2/level1.json":case"http://iiif.io/api/image/2/level2.json":return"ImageService2";case"http://iiif.io/api/auth/1/kiosk":case"http://iiif.io/api/auth/1/login":case"http://iiif.io/api/auth/1/clickthrough":case"http://iiif.io/api/auth/1/external":case"http://iiif.io/api/auth/0/kiosk":case"http://iiif.io/api/auth/0/login":case"http://iiif.io/api/auth/0/clickthrough":case"http://iiif.io/api/auth/0/external":return"AuthCookieService1";case"http://iiif.io/api/auth/1/token":case"http://iiif.io/api/auth/0/token":return"AuthTokenService1";case"http://iiif.io/api/auth/1/logout":case"http://iiif.io/api/auth/0/logout":return"AuthLogoutService1";case"http://iiif.io/api/search/1/search":case"http://iiif.io/api/search/0/search":return"SearchService1";case"http://iiif.io/api/search/1/autocomplete":case"http://iiif.io/api/search/0/autocomplete":return"AutoCompleteService1"}}function $(t){for(let e of["sc","oa","dcterms","dctypes","iiif"])if(t.startsWith(`${e}:`))return t.slice(e.length+1);return t}var ke=["Collection","Manifest","Annotation","AnnotationPage","Range","Service"];function A(t){let e=t["@id"]||t.id,i=t["@type"]||t.type,n=t.profile||void 0,a=t["@context"]||void 0;if(n){let r=je(n);if(r)return r}if(a){let r=Q(a);if(r)return r}if(i){if(Array.isArray(i)){if(i.indexOf("oa:CssStylesheet")!==-1)return"CssStylesheet";if(i.indexOf("cnt:ContentAsText")!==-1)return"TextualBody";i=i[0]}for(let r of["sc","oa","dcterms","dctypes","iiif"])if(i.startsWith(`${r}:`)){i=i.slice(r.length+1);break}switch(i){case"Layer":return"AnnotationCollection";case"AnnotationList":return"AnnotationPage";case"cnt:ContentAsText":return"TextualBody"}}if(i&&ke.indexOf(i)!==-1)return i;if(t.format){if(t.format.startsWith("image/"))return"Image";if(t.format.startsWith("text/")||t.format==="application/pdf")return"Text";if(t.format.startsWith("application/"))return"Dataset"}return e&&(e.endsWith(".jpg")||e.endsWith(".png")||e.endsWith(".jpeg"))?"Image":i||"unknown"}var Ve=/http(s)?:\/\/(creativecommons.org|rightsstatements.org)[^"'\\<\n]+/gm;function Be(t){let e=t.match(Ve);return e?e[0]:t}function qe(t,e="Rights/License",i="none"){let n=null,a=[],r=Array.isArray(t)?t:[t];for(let s of r){let l=s?Be(s):void 0;if(l&&(l.indexOf("creativecommons.org")!==-1||l.indexOf("rightsstatements.org")!==-1)){l.startsWith("https://")?n=`http://${l.slice(8)}`:n=l;continue}l&&a.push({label:{[i]:[e]},value:{[i]:[l]}})}return[n,a]}var We=["http://iiif.io/api/presentation/2/context.json","http://iiif.io/api/image/2/context.json","http://iiif.io/api/image/1/context.json","http://library.stanford.edu/iiif/image-api/1.1/context.json","http://iiif.io/api/search/1/context.json","http://iiif.io/api/search/0/context.json","http://iiif.io/api/auth/1/context.json","http://iiif.io/api/auth/0/context.json","http://iiif.io/api/annex/openannotation/context.json"];function Ue(t){if(t){let e=Array.isArray(t)?t:[t],i=[];for(let n of e)n==="http://iiif.io/api/presentation/2/context.json"&&i.push("http://iiif.io/api/presentation/3/context.json"),We.indexOf(n)===-1&&i.push(n);if(e.length)return i.length===1?i[0]:i}}function ze(t){return t?t.map(e=>({label:c(e.label),value:c(e.value)})):[]}var H=0;function K(t,e){let i=encodeURI(t.id||t["@id"]||"").trim();return i&&e?`${i}/${e}`:i||(H++,`http://example.org/${t["@type"]}${e?`/${e}`:""}/${H}`)}function p(t){let e=[...t.behavior||[]];t.viewingHint&&e.push(t.viewingHint);let i;return Array.isArray(t.motivation)?i=t.motivation.map($):t.motivation&&(i=$(t.motivation)),{"@context":t["@context"]?Ue(t["@context"]):void 0,id:(t["@id"]||K(t)).trim(),type:A(t),behavior:e.length?e:void 0,height:t.height?t.height:void 0,width:t.width?t.width:void 0,motivation:i,viewingDirection:t.viewingDirection,profile:t.profile,format:t.format?t.format:void 0,duration:void 0,timeMode:void 0}}function f(t){let[e,i]=qe(t.license),n=[...t.metadata?ze(t.metadata):[],...i];return{rights:e,metadata:n.length?n:void 0,label:t.label?c(t.label):void 0,requiredStatement:t.attribution?{label:c(m.attributionLabel),value:c(t.attribution)}:void 0,navDate:t.navDate,summary:t.description?c(t.description):void 0,thumbnail:$e(t.thumbnail)}}function $e(t){return t&&(Array.isArray(t)?t:[t]).map(i=>typeof i=="string"?{id:i,type:"Image"}:(i.type==="unknown"&&(i.type="Image"),i))}function He(t){if(!t.within)return;let e=Array.isArray(t.within)?t.within:[t.within],i=[];for(let n of e)if(typeof n=="string"){if(n)switch(t["@type"]){case"sc:Manifest":i.push({id:n,type:"Collection"});break}}else n["@id"]&&i.push({id:n["@id"],type:A(n)});return i.length?i:void 0}function h(t){let e=t.related?Array.isArray(t.related)?t.related:[t.related]:[],i=t.contentLayer;return{provider:t.logo||e.length?[{id:m.providerId,type:"Agent",homepage:e.length?[e[0]]:void 0,logo:t.logo?Array.isArray(t.logo)?t.logo:[t.logo]:void 0,label:c(m.providerName)}]:void 0,partOf:He(t),rendering:t.rendering,seeAlso:t.seeAlso,start:t.startCanvas,service:t.service?x(t.service):void 0,supplementary:i?[i]:void 0}}function Je(t){return{chars:t.chars,format:t.format?t.format:void 0,language:t.language}}function Qe(t){return o({...p(t),...f(t),...h(t),items:t.members})}function Ke(t){let e=[],i=[],n,a;for(let s of t.sequences||[])console.log(s),s.canvases.length&&e.push(...s.canvases),s.behavior&&i.push(...s.behavior),s.viewingDirection&&(a=s.viewingDirection),s.startCanvas&&(n=s.startCanvas);let r=p(t);return i.length&&(r.behavior?r.behavior.push(...i):r.behavior=i),o({...r,...f(t),...h(t),viewingDirection:a,start:n,items:e,structures:Xe(t.structures)})}function Xe(t){if(!t)return t;let e=new Map;for(let n of t)e.set(n.id,n);let i=[];for(let n of t)if(n.items){let a=n.items.map(r=>typeof r=="string"?(i.push(r),e.get(r)||r):r&&r.id?(i.push(r.id),e.get(r.id)||r):r);n.items=a}return t.filter(n=>i.indexOf(n.id)===-1)}function Ye(t){return o({...p(t),...f(t),...h(t),annotations:t.otherContent&&t.otherContent.length?t.otherContent:void 0,items:t.images&&t.images.length?[{id:K(t,"annotation-page"),type:"AnnotationPage",items:t.images}]:void 0})}function Ze(t){return o({...p(t),...f(t),...h(t),items:t.resources&&t.resources.length?t.resources:void 0})}function et(t){return!t.canvases||t.canvases.length===0?{canvases:[],behavior:[]}:{canvases:t.canvases,behavior:t.viewingHint?[t.viewingHint]:[],viewingDirection:t.viewingDirection,startCanvas:t.startCanvas}}function tt(t){function e(i){if(Array.isArray(i)){if(i.length>1)return{type:"List",items:i.map(e)};i=i[0]}if(typeof i=="string")return encodeURI(i).trim();if("@type"in i){let n;if(typeof i.full=="string")n=i.full;else if(i.full["@type"]==="dctypes:Image")n={id:i.full["@id"],type:"Image"};else if(i.full["@type"]==="sc:Canvas")n={id:i.full["@id"],type:"Canvas"};else throw new Error(`Unsupported source type on annotation: ${i.full["@type"]}`);return{type:"SpecificResource",source:n,selector:I(i.selector)}}else return encodeURI(i["@id"]).trim()}return o({...p(t),...f(t),...h(t),target:e(t.on),body:Array.isArray(t.resource)?t.resource.map(J):J(t.resource)})}function J(t){return t.type==="Choice"?t:X(t)}function X(t){let e=t;return o({...p(e),...f(e),...h(e),...Je(e)})}function it(t){let e=[];return t.default&&t.default!=="rdf:nil"&&e.push(t.default),t.item&&t.item!=="rdf:nil"&&e.push(...t.item),o({...p(t),...f(t),items:e})}function nt(t){return o({...p(t),...f(t),...h(t),items:t.members})}function rt(t){let{"@id":e,"@type":i,"@context":n,profile:a,...r}=t,s={};return e&&(s["@id"]=e),s["@type"]=A(t),s["@type"]==="unknown"&&(n&&n.length&&(s["@context"]=n),s["@type"]="Service"),a&&(s.profile=_(a)),o({...s,...r})}function at(t){return o({...p(t),...f(t),...h(t)})}var Y=new u({collection:[Qe],manifest:[Ke],canvas:[Ye],annotationList:[Ze],sequence:[et],annotation:[tt],contentResource:[X],choice:[it],range:[nt],service:[rt],layer:[at]});function st(t){return t&&t["@context"]&&(t["@context"]==="http://iiif.io/api/presentation/2/context.json"||t["@context"].indexOf("http://iiif.io/api/presentation/2/context.json")!==-1||t["@context"]==="http://www.shared-canvas.org/ns/context.json")||t["@context"]==="http://iiif.io/api/image/2/context.json"?Y.traverseUnknown(t):t}function I(t){if((Array.isArray(t["@type"])&&t["@type"].includes("oa:SvgSelector")||t["@type"]=="oa:SvgSelector")&&("chars"in t||"value"in t))return{type:"SvgSelector",value:"chars"in t?t.chars:t.value};if(t["@type"]==="oa:FragmentSelector")return{type:"FragmentSelector",value:t.value};if(t["@type"]==="oa:Choice")return[I(t.default),...(Array.isArray(t.item)?t.item:[t.item]).map(I)];if(t["@type"]=="iiif:ImageApiSelector")return{type:"ImageApiSelector",region:"region"in t?t.region:void 0,rotation:"rotation"in t?t.rotation:void 0};throw new Error(`Unsupported selector type: ${t["@type"]}`)}return ae(ot);})();
